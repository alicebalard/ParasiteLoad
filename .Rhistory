!is.na(BALdata$Sex) &
!is.na(BALdata$qPCRstatus) ,]
WATWMdata <- WATWMdata[!is.na(WATWMdata$`Aspiculuris.Syphacia+1`) &
!is.na(WATWMdata$HI) &
!is.na(WATWMdata$Sex), ]
# all worms together for comparison
d1 <- WATWMdata[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d2 <- pinworms_data[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d1$batch <- "WATWM"
d2$batch <- "JENNY"
allWorms <- rbind(d1,d2)
allWorms$batch <- as.factor(allWorms$batch)
```
## Worms count, 4 hypotheses, difference between sexes (Baird et al. 2012 for details)
First, choose a correct distribution for our data : negative binomial. We validate this distribution as follow
```{r}
x <- BALdata$Aspiculuris_Syphacia[!is.na(BALdata$Aspiculuris_Syphacia)]
averageload <- round(mean(x, na.rm = T),1)
averageload # [1] 19.7
Ni <- sum(x !=0, na.rm = T)
Ni # [1] 321
# Confidence intervals calculated with Sterne's exact method
sternetest <- epiR::epi.prev(pos = length(x[x > 0]), tested = length(x),
se = 1, sp=1, conf.level = .95, method = "sterne")
cilow <- sternetest$ap["lower"]
cihigh <- sternetest$ap["upper"]
prevalence <- sternetest$ap["est"]
Ni # [1] 321
prevalence # 52.88303
cilow # 48.84618
cihigh # 56.84016
Meanload <-  mean(x, na.rm = T)
max <- max(x, na.rm = T)
Meanload # 19.67216
max # 489
set.seed(8345) # to make it replicable
b1 <- one.boot(x, mean, R=10000)
b1$t0 # 39.18529
boot.ci(b1, type=c("bca"))
# BOOTSTRAP CONFIDENCE INTERVAL CALCULATIONS
# Based on 1000 bootstrap replicates
# Level       BCa
# 95%   (16.22, 24.56 )
# Prevalence Ni (%)
# [CI 95%]
# 321 (52.9%)
# [48.85–56.84]
# Mean load (Max)
# [CI 95%]
# 19.67 (489)
# [16.22–24.56]
## MLE of parameter k negbin
hist(x, prob=T, breaks = max(x))
# fit the negative binomial distribution
fit <- fitdist(x, "nbinom")
# get the fitted densities. mu and size from fit.
fitD <- dnbinom(0:max(x), size=fit$estimate[1], mu=fit$estimate[2])
# add fitted line (blue) to histogram
lines(fitD, lwd="3", col="blue")
# Goodness of fit with the chi squared test
# get the frequency table
t <- table(x)
# convert to dataframe
df <- as.data.frame(t)
df$x <- as.numeric(as.character(df$x))
df$expp <- pnbinom(q = df$x, size=fit$estimate[1], mu = fit$estimate[2])
df$obsp <- cumsum(df$Freq / sum(df$Freq))
# perform the chi-squared test
chisq.test(x = df$expp, y = df$obsp)
# Pearson's Chi-squared test
#
# data:  df$expp and df$obsp
# X-squared = 9120, df = 9025, p-value = 0.239
# Observed and expected frequencies do not differ significantly (P =
# 0.05) so there is no statistical evidence to reject H 0
size=fit$estimate[1]
size # 0.1604875
# k
# 0.160*
# The negative binomial distribution seems to describe parasite load well for all parasites
```
### pinworms (A. tetraptera and S. obvelata (WATWMdata$Aspiculuris.Syphacia))
```{r runfitJo, fig.width=7, fig.height=4}
fit_Joelle_negbin <- analyse(WATWMdata, "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex")
fit_Joelle_negbin
plot_Joelle_negbin <- bananaPlots(mod = fit_Joelle_negbin$H1,
data = WATWMdata,
response = "Aspiculuris.Syphacia+1",
islog10 = TRUE, group = "Sex")
plot_Joelle_negbin
```
### And Jennys now:
```{r runfitJe,  fig.width=7, fig.height=4}
fit_pinworms_negbin <- analyse(pinworms_data, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex")
fit_pinworms_negbin
plot_pinworms_negbin <- bananaPlots(mod = fit_pinworms_negbin$H3,
data = pinworms_data,
response = "Aspiculuris.Syphacia+1",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbin
```
roxygen2::roxygenize()
library(parasiteLoad)
source('~/Schreibtisch/git_projects/parasiteLoad/R/runAll.R')
library(parasiteLoad)
source('~/Schreibtisch/git_projects/parasiteLoad/R/analyse.R')
library(parasiteLoad)
source('~/Schreibtisch/git_projects/parasiteLoad/R/runAll.R')
source('~/Schreibtisch/git_projects/parasiteLoad/R/analyse.R')
library(parasiteLoad)
getParamBounds(model, data, response)
getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
paramAlphaFixed <- getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
paramAlphaFixed["alphaStart"]
paramAlphaFixed <- getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
paramAlphaFixed["alphaStart"] <- 1.4
paramAlphaFixed["alphaLB"] <- 1.4
paramAlphaFixed["alphaUB"] <- 1.4
paramAlphaFixed
fit_pinworms_negbin <- analyse(pinworms_data, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex", myparamBounds = paramAlphaFixed)
paramAlphaFixed <- getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
paramAlphaFixed["alphaStart"] <- 1.4
paramAlphaFixed["alphaLB"] <- 1.4
paramAlphaFixed["alphaUB"] <- 1.4
fit_pinworms_negbinB <- analyse(pinworms_data, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex",
myparamBounds = paramAlphaFixed)
paramAlphaFixed <- getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
library(parasiteLoad)
library(bbmle)
require(optimx) # for bbmle it needs to be required(?)
library(ggplot2)
library(MASS)
library(fitdistrplus) # evaluate distribution
library(epiR) # Sterne's exact method
library(simpleboot) # BS
library(boot) # BS
# add 1 for worms/oocysts count!!
WATWMdata$`Aspiculuris.Syphacia+1` <- WATWMdata$Aspiculuris.Syphacia + 1
BALdata$`Aspiculuris.Syphacia+1` <- BALdata$Aspiculuris_Syphacia + 1
BALdata$`OPG+1` <- BALdata$OPG + 1
# and select variables for each analysis
qpcr_data <- BALdata[!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$delta_ct_MminusEAllPos), ]
flotation_data <- BALdata[!is.na(BALdata$`OPG+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex), ]
pinworms_data <- BALdata[!is.na(BALdata$`Aspiculuris.Syphacia+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex),]
body_data <- BALdata[!is.na(BALdata$Body_weight) &
!is.na(BALdata$Body_length) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$qPCRstatus) ,]
WATWMdata <- WATWMdata[!is.na(WATWMdata$`Aspiculuris.Syphacia+1`) &
!is.na(WATWMdata$HI) &
!is.na(WATWMdata$Sex), ]
# all worms together for comparison
d1 <- WATWMdata[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d2 <- pinworms_data[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d1$batch <- "WATWM"
d2$batch <- "JENNY"
allWorms <- rbind(d1,d2)
allWorms$batch <- as.factor(allWorms$batch)
# add 1 for worms/oocysts count!!
WATWMdata$`Aspiculuris.Syphacia+1` <- WATWMdata$Aspiculuris.Syphacia + 1
BALdata$`Aspiculuris.Syphacia+1` <- BALdata$Aspiculuris_Syphacia + 1
BALdata$`OPG+1` <- BALdata$OPG + 1
# and select variables for each analysis
qpcr_data <- BALdata[!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$delta_ct_MminusEAllPos), ]
flotation_data <- BALdata[!is.na(BALdata$`OPG+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex), ]
pinworms_data <- BALdata[!is.na(BALdata$`Aspiculuris.Syphacia+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex),]
body_data <- BALdata[!is.na(BALdata$Body_weight) &
!is.na(BALdata$Body_length) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$qPCRstatus) ,]
WATWMdata <- WATWMdata[!is.na(WATWMdata$`Aspiculuris.Syphacia+1`) &
!is.na(WATWMdata$HI) &
!is.na(WATWMdata$Sex), ]
# all worms together for comparison
d1 <- WATWMdata[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d2 <- pinworms_data[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d1$batch <- "WATWM"
d2$batch <- "JENNY"
allWorms <- rbind(d1,d2)
allWorms$batch <- as.factor(allWorms$batch)
fit_pinworms_negbin <- analyse(pinworms_data, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex")
fit_pinworms_negbin
plot_pinworms_negbin <- bananaPlots(mod = fit_pinworms_negbin$H3,
data = pinworms_data,
response = "Aspiculuris.Syphacia+1",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbin
paramAlphaFixed <- getParamBounds(model = "negbin", data = pinworms_data, response= "Aspiculuris.Syphacia+1")
paramAlphaFixed[c("alphaStart", "alphaLB", "alphaUB")] #<- 1.4
paramAlphaFixed[c("alphaStart", "alphaLB", "alphaUB")] <- c(1.4, 1.34, 1.44)
paramAlphaFixed
fit_pinworms_negbinB <- analyse(pinworms_data, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex",
myparamBounds = paramAlphaFixed)
fit_pinworms_negbinB
fit_pinworms_negbinB$H3
Gtest(fit_pinworms_negbinB$H3, fit_pinworms_negbin$H3)
library(parasiteLoad)
library(parasiteLoad)
xPOS <- BALdata$Aspiculuris_Syphacia[!is.na(BALdata$Aspiculuris_Syphacia) &
BALdata$Aspiculuris_Syphacia > 1]
xPos
xPOS
xPOS <- BALdata$Aspiculuris_Syphacia[!is.na(BALdata$Aspiculuris_Syphacia) &
BALdata$Aspiculuris_Syphacia >= 1]
xPOS
pinworms_data
pinworms_dataPOS <- pinworms_data[pinworms_data$Aspiculuris_Syphacia >= 1, ]
fit_pinworms_negbinPOS <- analyse(, response = "Aspiculuris.Syphacia+1",
model = "negbin", group = "Sex")
fit_pinworms_negbinPOS <- analyse(pinworms_dataPOS, response = "Aspiculuris_Syphacia",
model = "negbin", group = "Sex")
fit_pinworms_negbinPOS
plot_pinworms_negbinPOS <- bananaPlots(mod = fit_pinworms_negbin$H3,
data = pinworms_data,
response = "Aspiculuris.Syphacia+1",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbinPOS <- bananaPlots(mod = fit_pinworms_negbin$H3,
data = pinworms_data,
response = "Aspiculuris_Syphacia",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbinPOS
plot_pinworms_negbinPOS <- bananaPlots(mod = fit_pinworms_negbinPOS$H3,
data = pinworms_dataPOS,
response = "Aspiculuris_Syphacia",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbinPOS
plot_pinworms_negbinPOS
pinworms_dataPOS <- pinworms_data[pinworms_data$Aspiculuris_Syphacia >= 1, ]
fit_pinworms_negbinPOS <- analyse(pinworms_dataPOS, response = "Aspiculuris_Syphacia",
model = "negbin", group = "Sex")
fit_pinworms_negbinPOS
plot_pinworms_negbinPOS <- bananaPlots(mod = fit_pinworms_negbinPOS$H3,
data = pinworms_dataPOS,
response = "Aspiculuris_Syphacia",
islog10 = TRUE, group = "Sex")
plot_pinworms_negbinPOS
png("../Articles_HMHZ/Article1_wild/figures/fig3.png")
plot_pinworms_negbinPOS
dev.off
dev.off()
pdf("../Articles_HMHZ/Article1_wild/figures/fig3.pdf")
plot_pinworms_negbinPOS
dev.off()
pdf("../Articles_HMHZ/Article1_wild/figures/fig3.pdf", width=7, height=4)
plot_pinworms_negbinPOS
dev.off()
plot_pinworms_negbinPOS
52.9%/321
52.9/100/321
321/52.9/100
321/(52.9/100)
320/(52.9/100)
320/605
qpcrPOS <- qpcr_data[qpcr_data$delta_ct_MminusEAllPos > 0, "delta_ct_MminusEAllPos"]
qpcrPOS
fitdistrplus::descdist(qpcrPOS, discrete = FALSE)
fits_test_qpcr <- list(
normal = fitdistrplus::fitdist(qpcrPOS, "norm"),
weibull = fitdistrplus::fitdist(qpcrPOS, "weibull"),
student = fitdistrplus::fitdist(qpcrPOS, "t", start = list(df = 1))
)
plot(fits_test_qpcr$normal)
plot(fits_test_qpcr$weibull)
plot(fits_test_qpcr$student)
#Get the logliks for each model...
sapply(fits_test_qpcr, function(i) i$loglik)
sapply(fits_test_qpcr, function(i) i$aic)
averageload <- round(mean(qpcrPOS, na.rm = T),1)
averageload
Ni <- sum(qpcrPOS !=0, na.rm = T)
Ni
library(parasiteLoad)
library(bbmle)
require(optimx) # for bbmle it needs to be required(?)
library(ggplot2)
library(MASS)
library(fitdistrplus) # evaluate distribution
library(epiR) # Sterne's exact method
library(simpleboot) # BS
library(boot) # BS
# add 1 for worms/oocysts count!!
WATWMdata$`Aspiculuris.Syphacia+1` <- WATWMdata$Aspiculuris.Syphacia + 1
BALdata$`Aspiculuris.Syphacia+1` <- BALdata$Aspiculuris_Syphacia + 1
BALdata$`OPG+1` <- BALdata$OPG + 1
# and select variables for each analysis
qpcr_data <- BALdata[!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$delta_ct_MminusEAllPos), ]
flotation_data <- BALdata[!is.na(BALdata$`OPG+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex), ]
pinworms_data <- BALdata[!is.na(BALdata$`Aspiculuris.Syphacia+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex),]
body_data <- BALdata[!is.na(BALdata$Body_weight) &
!is.na(BALdata$Body_length) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$qPCRstatus) ,]
WATWMdata <- WATWMdata[!is.na(WATWMdata$`Aspiculuris.Syphacia+1`) &
!is.na(WATWMdata$HI) &
!is.na(WATWMdata$Sex), ]
# all worms together for comparison
d1 <- WATWMdata[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d2 <- pinworms_data[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d1$batch <- "WATWM"
d2$batch <- "JENNY"
allWorms <- rbind(d1,d2)
allWorms$batch <- as.factor(allWorms$batch)
```
First, choose a correct distribution for our data
```{r}
qpcrPOS <- qpcr_data[qpcr_data$delta_ct_MminusEAllPos > 0, "delta_ct_MminusEAllPos"]
fitdistrplus::descdist(qpcrPOS, discrete = FALSE)
fits_test_qpcr <- list(
normal = fitdistrplus::fitdist(qpcrPOS, "norm"),
weibull = fitdistrplus::fitdist(qpcrPOS, "weibull"),
student = fitdistrplus::fitdist(qpcrPOS, "t", start = list(df = 1))
)
plot(fits_test_qpcr$normal)
plot(fits_test_qpcr$weibull)
plot(fits_test_qpcr$student)
#Get the logliks for each model...
sapply(fits_test_qpcr, function(i) i$loglik)
sapply(fits_test_qpcr, function(i) i$aic)
averageload <- round(mean(qpcrPOS, na.rm = T),1)
averageload
speciesEimeria <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/Eimeria_species_assignment_14_17.csv")
speciesEimeria$Mouse_ID
View(speciesEimeria)
merge(qpcr_data, speciesEimeriaMouse_ID)
merge(qpcr_data, speciesEimeria)
merge(qpcr_data, speciesEimeria, by = "Mouse_ID")
merge(qpcr_data, speciesEimeria, by = "Mouse_ID")
qpcr_data_species <- merge(qpcr_data, speciesEimeria, by = "Mouse_ID")
View(qpcr_data_species)
qpcr_data_species <- merge(qpcr_data, speciesEimeria, by = "Mouse_ID", all = T)
speciesEimeria
speciesEimeria[c("Code", "Transect")]
speciesEimeria[-c("Code", "Transect")]
# speciesEimeria[
names(speciesEimeria) %in% c("Code", "Transect")
# speciesEimeria[
!names(speciesEimeria) %in% c("Code", "Transect")
speciesEimeria[!names(speciesEimeria) %in% c("Code", "Transect")]
speciesEimeria <- speciesEimeria[!names(speciesEimeria) %in% c("Code", "Transect")]
as.character(speciesEimeria$Mouse_ID)
gsub(" ", "", as.character(speciesEimeria$Mouse_ID))
speciesEimeria$Mouse_ID <- gsub(" ", "", as.character(speciesEimeria$Mouse_ID))
speciesEimeria$Mouse_ID
speciesEimeria <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/Eimeria_species_assignment_14_17.csv")
speciesEimeria <- speciesEimeria[!names(speciesEimeria) %in% c("Code", "Transect")]
speciesEimeria
View(speciesEimeria)
speciesEimeria$Mouse_ID
grep("c", speciesEimeria$Mouse_ID)
speciesEimeria$Mouse_ID[grep("c", speciesEimeria$Mouse_ID)]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0080c",]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0080i",]
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0100i",]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0100c",]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0100",]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0100c",]
## NB. double infection for AA_0080 + cecum only for AA_0100
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
## NB. double infection for AA_0080 + cecum only for AA_0100
speciesEimeria$Mouse_ID[grep("i" | "c", speciesEimeria$Mouse_ID)]
## NB. double infection for AA_0080 + cecum only for AA_0100
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
speciesEimeria$Mouse_ID[grep("c", speciesEimeria$Mouse_ID)]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0080c",]
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0080i",]
data.frame(Mouse_ID = "AA_0080", Species = "E_vermiformis_E_ferrisi")
speciesEimeria[speciesEimeria$Mouse_ID %in% "AA_0100c",]
data.frame(Mouse_ID = c("AA_0080", "AA_0100"),
data.frame(Mouse_ID = c("AA_0080", "AA_0100"),
Species = c("E_vermiformis_E_ferrisi", "Double"))
c=)
data.frame(Mouse_ID = c("AA_0080", "AA_0100"),
Species = c("E_vermiformis_E_ferrisi", "Double"))
rbind(data.frame(Mouse_ID = c("AA_0080", "AA_0100"),
Species = c("E_vermiformis_E_ferrisi", "Double")), speciesEimeria)
rbind(data.frame(Year = c(2016, 2016),
Mouse_ID = c("AA_0080", "AA_0100"),
n18S_Seq = "positive",
COI_Seq = "positive",
ORF470_Seq = "positive",
Species = c("E_vermiformis_E_ferrisi", "Double")), speciesEimeria)
speciesEimeria <- rbind(data.frame(Year = c(2016, 2016),
Mouse_ID = c("AA_0080", "AA_0100"),
n18S_Seq = "positive",
COI_Seq = "positive",
ORF470_Seq = "positive",
Species = c("E_vermiformis_E_ferrisi", "Double")), speciesEimeria)
speciesEimeria$Mouse_ID <- gsub(" ", "", as.character(speciesEimeria$Mouse_ID))
speciesEimeria$Mouse_ID
qpcr_data_species <- merge(qpcr_data, speciesEimeria, by = "Mouse_ID", all = T)
qpcr_data_species <- merge(qpcr_data, speciesEimeria, by = "Mouse_ID")
View(qpcr_data_species)
View(qpcr_data_species)
duplicated(qpcr_data_species$Mouse_ID)
qpcr_data_species$Mouse_ID[duplicated(qpcr_data_species$Mouse_ID)]
speciesEimeria <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/Eimeria_species_assignment_14_17.csv")
speciesEimeria <- speciesEimeria[!names(speciesEimeria) %in% c("Code", "Transect")]
## NB. double infection for AA_0080 + cecum only for AA_0100
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
speciesEimeria$Mouse_ID[grep("c", speciesEimeria$Mouse_ID)]
speciesEimeria <- rbind(data.frame(Year = c(2016, 2016),
Mouse_ID = c("AA_0080", "AA_0100"),
n18S_Seq = "positive",
COI_Seq = "positive",
ORF470_Seq = "positive",
Species = c("E_vermiformis_E_ferrisi", "Double")), speciesEimeria)
speciesEimeria$Mouse_ID <- gsub(" ", "", as.character(speciesEimeria$Mouse_ID))
qpcr_data_species <- merge(qpcr_data, speciesEimeria, by = "Mouse_ID")
qpcr_data_species$Mouse_ID[duplicated(qpcr_data_species$Mouse_ID)]
speciesEimeria <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/Eimeria_species_assignment_14_17.csv")
speciesEimeria <- speciesEimeria[!names(speciesEimeria) %in% c("Code", "Transect")]
## NB. double infection for AA_0080 + cecum only for AA_0100
speciesEimeria$Mouse_ID[grep("i", speciesEimeria$Mouse_ID)]
speciesEimeria$Mouse_ID[grep("c", speciesEimeria$Mouse_ID)]
speciesEimeria$Mouse_ID[grep("AA_0080", speciesEimeria$Mouse_ID)]
speciesEimeria[grep("AA_0080", speciesEimeria$Mouse_ID),]
speciesEimeria[grep("AA_0100", speciesEimeria$Mouse_ID),]
speciesEimeria[grep("Double", speciesEimeria$Species),]
qpcr_data[grep("AA_0080", speciesEimeria$Mouse_ID),]
View(speciesEimeria)
qpcr_data[grep("AA_0080", qpcr_data$Mouse_ID),]
speciesEimeria[grep("AA_0080", speciesEimeria$Mouse_ID),]
qpcr_data[grep("AA_0100", qpcr_data$Mouse_ID),]
View(qpcr_data)
qpcr_data[grep("SK_3127", qpcr_data$Mouse_ID),]
qpcr_data[grep("3127", qpcr_data$Mouse_ID),]
qpcr_data[grep("0111", qpcr_data$Mouse_ID),]
qpcr_data[grep("0112", qpcr_data$Mouse_ID),]
qpcr_data[grep("0139", qpcr_data$Mouse_ID),]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"]
qpcr_data["delta_ct_cewe_MminusE", "delta_ct_ilwe_MminusE"]
qpcr_data[c("delta_ct_cewe_MminusE", "delta_ct_ilwe_MminusE")]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),
c("Mouse_ID", "delta_ct_cewe_MminusE", "delta_ct_ilwe_MminusE")]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),
c("Mouse_ID")]
speciesEimeria[speciesEimeria$Mouse_ID %in% qpcr_data[grep("stronger", qpcr_data$qPCRsummary),
c("Mouse_ID")],]
speciesEimeria <- read.csv("https://raw.githubusercontent.com/derele/Mouse_Eimeria_Databasing/master/raw_data/Eimeria_detection/Eimeria_species_assignment_14_17.csv")
speciesEimeria[speciesEimeria$Mouse_ID %in% qpcr_data[grep("stronger", qpcr_data$qPCRsummary),
c("Mouse_ID")],]
speciesEimeria$Mouse_ID %in% "AA_0068"
View(speciesEimeria)
qpcr_data <- BALdata[!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$delta_ct_MminusEAllPos), ]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],]
-2.34+5
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],]
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE"]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE")]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE")]
qpcr_data[qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"]
qpcr_data[qpcr_data$Mouse_ID %in% qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
tocheck <- qpcr_data[qpcr_data$Mouse_ID %in% qpcr_data[grep("stronger", qpcr_data$qPCRsummary),"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
tocheck$delta_ct_ilwe_MminusE > -5 & tocheck$delta_ct_cewe_MminusE > -5
tocheck[tocheck$delta_ct_ilwe_MminusE > -5 & tocheck$delta_ct_cewe_MminusE > -5 ]
tocheck[tocheck$delta_ct_ilwe_MminusE > -5 & tocheck$delta_ct_cewe_MminusE > -5, ]
tocheck <- tocheck[tocheck$delta_ct_ilwe_MminusE > -5 & tocheck$delta_ct_cewe_MminusE > -5, ]
qpcr_data[qpcr_data$Mouse_ID %in%
qpcr_data[qpcr_data$delta_ct_ilwe_MminusE > -5 &
qpcr_data$delta_ct_cewe_MminusE > -5,"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
tocheck <- qpcr_data[qpcr_data$Mouse_ID %in%
qpcr_data[qpcr_data$delta_ct_ilwe_MminusE > -5 &
qpcr_data$delta_ct_cewe_MminusE > -5,"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
tocheck <- qpcr_data[qpcr_data$Mouse_ID %in%
qpcr_data[qpcr_data$delta_ct_ilwe_MminusE > -5 &
qpcr_data$delta_ct_cewe_MminusE > -5,"Mouse_ID"],
c("Mouse_ID", "delta_ct_ilwe_MminusE", "delta_ct_cewe_MminusE", "qPCRsummary")]
write.csv(tocheck, "../../../Schreibtisch/tocheck.csv", row.names = F)
