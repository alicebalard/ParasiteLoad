geom_rect(xmin = 11.8, xmax = 12.8, ymin = 50.9, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 20,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11.8, xmax = 12.8, ymin = 50.9, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 20,
distance_lon = 10, distance_lat = 5, distance_legend = 20,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11.8, xmax = 12.8, ymin = 50.9, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 20,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11.8, xmax = 12.8, ymin = 50.9, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11.8, xmax = 12.8, ymin = 50.9, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.8, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 12, lat = 51, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.8, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, )
dev.off()
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2)
dev.off()
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 2)
dev.off()
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 2.5)
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 2.5)
dev.off()
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 15,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
dev.off()
BALdata <- read.csv("data/MiceTableMusAliceArticle.csv")
BALdata <- BALdata[BALdata$Year %in% c(2014:2017),]
# miceTable[!is.na(miceTable$Latitude) &
#             miceTable$Latitude > 51.5 &
#             miceTable$Latitude < 53.4 &
#             miceTable$Longitude < 14.6 &
#             miceTable$Longitude > 12, ]
# miceTable <- miceTable[miceTable$Year %in% c("2015", "2016", "2017"),]
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(BALdata)
#plot the map :
# devtools::install_github("3wen/legendMap")
library(legendMap)
pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
dev.off()
library(parasiteLoad)
View(BALdata)
load("/home/alice/Schreibtisch/git_projects/parasiteLoad/data/BALdata.Rdata")
library(parasiteLoad)
roxygen2::roxygenise()
View(BALdata)
table(BALdata$year)
table(BALdata$Year)
sum(table(BALdata$Year))
library(parasiteLoad)
library(parasiteLoad)
roxygen2::roxygenise()
WATWMdata <- read.csv("../data/WATWMdata.csv")
library(parasiteLoad)
library(bbmle)
require(optimx) # for bbmle it needs to be required(?)
library(ggplot2)
library(MASS)
library(fitdistrplus) # evaluate distribution
library(epiR) # Sterne's exact method
library(simpleboot) # BS
library(boot) # BS
WATWMdata <- read.csv("../data/WATWMdata.csv")
BALdata <- read.csv("../data/BALdata.csv")
# select variables for each analysis
flotation <- BALdata[!is.na(BALdata$OPG) &
BALdata$OPG >= 1 &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex), ]
flotation$OPG <- round(flotation$OPG)
qpcr <- BALdata[(BALdata$delta_ct_cewe_MminusE > -5 &
!is.na(BALdata$delta_ct_cewe_MminusE)) |
(BALdata$delta_ct_ilwe_MminusE > -5 &
!is.na(BALdata$delta_ct_ilwe_MminusE)),]
df <- qpcr[, c("delta_ct_cewe_MminusE", "delta_ct_ilwe_MminusE")]
qpcr$delta_ct_max_MminusEPOS <- apply(df, 1, function(x){ max(x, na.rm = T)}) + 5
ggplot(qpcr,
aes(x = HI, y = delta_ct_max_MminusEPOS)) +
geom_point() +
theme_classic()
qpcrvalue <- qpcr$delta_ct_max_MminusEPOS
fitdistrplus::descdist(qpcrvalue, discrete = FALSE)
fits_test_qpcr <- list(
normal = fitdistrplus::fitdist(qpcrvalue, "norm"),
weibull = fitdistrplus::fitdist(qpcrvalue, "weibull"),
student = fitdistrplus::fitdist(qpcrvalue, "t", start = list(df = 1))
)
plot(fits_test_qpcr$normal)
plot(fits_test_qpcr$weibull)
plot(fits_test_qpcr$student)
#Get the logliks for each model...
sapply(fits_test_qpcr, function(i) i$loglik)
sapply(fits_test_qpcr, function(i) i$aic)
fit_qpcr_weibull <- analyse(qpcr,
response = "delta_ct_max_MminusEPOS",
model = "weibull", group = "Sex")
fit_qpcr_weibull
plot_qpcr_weibull <- bananaPlots_alpha(mod = fit_qpcr_weibull$H1,
data = qpcr,
response = "delta_ct_max_MminusEPOS",
group = "Sex")
plot_qpcr_weibull
pdf(width = 6, height = 4, file = "../figures/part3_alpha.pdf")
plot_qpcr_weibull
dev.off()
# to compare
plot_qpcr_weibull2 <- bananaPlots(mod = fit_qpcr_weibull$H1,
data = qpcr,
response = "delta_ct_max_MminusEPOS",
group = "Sex")
fit_qpcr_weibull <- analyse(qpcr,
response = "delta_ct_max_MminusEPOS",
model = "weibull", group = "Sex")
fit_qpcr_weibull
plot_qpcr_weibull <- bananaPlots_alpha(mod = fit_qpcr_weibull$H1,
data = qpcr,
response = "delta_ct_max_MminusEPOS",
group = "Sex")
plot_qpcr_weibull
pdf(width = 6, height = 4, file = "../figures/part3_alpha.pdf")
plot_qpcr_weibull
dev.off()
# to compare
plot_qpcr_weibull2 <- bananaPlots(mod = fit_qpcr_weibull$H1,
data = qpcr,
response = "delta_ct_max_MminusEPOS",
group = "Sex")
plot_qpcr_weibull2
pdf(width = 6, height = 4, file = "../figures/part3_allparamvary.pdf")
plot_qpcr_weibull2
dev.off()
fit_flotation <- analyse(flotation,
response = "OPG",
model = "negbin", group = "Sex")
fit_flotation
bananaplot <- bananaPlots(mod = fit_flotation$H1, data = flotation,
response = "OPG", group = "Sex", islog10 = T)
fit_flotation <- analyse(flotation,
response = "OPG",
model = "negbin", group = "Sex")
fit_flotation
bananaplot <- bananaPlots_alpha(mod = fit_flotation$H1, data = flotation,
response = "OPG", group = "Sex", islog10 = T)
bananaplot
pdf(file = "../figures/part3_opgalphavary.pdf", width = 6, height = 4)
bananaplot
dev.off()
body_data <- BALdata[!is.na(BALdata$Body_weight) &
!is.na(BALdata$Body_length) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex) &
!is.na(BALdata$eimeriaSpecies) &
BALdata$eimeriaSpecies %in% c("E_ferrisi") &
!is.na(BALdata$delta_ct_cewe_MminusE) &
BALdata$delta_ct_cewe_MminusE > -5,]
body_data$status[body_data$Sex %in% c("F")] <- "non pregnant/lactating female"
body_data$status[body_data$Status %in% c("post partum", "post partum (lactating)", "pregnant")] <- "pregnant/lactating female"
body_data$status[body_data$Sex %in% c("M")] <- "male"
# Test  our detection of pregnancy in females using BCI
ggplot2::ggplot(body_data,
ggplot2::aes(x = HI, y = BCI, fill = status, group = status)) +
geom_point(pch = 21, size = 3, alpha = .5)+
geom_smooth(aes(col = status)) +
theme_bw()
# Remove pregnant females
body_data <- body_data[!body_data$status %in% c("pregnant/lactating female"), ]
library(parasiteLoad)
library(bbmle)
require(optimx) # for bbmle it needs to be required(?)
library(ggplot2)
library(MASS)
library(fitdistrplus) # evaluate distribution
library(epiR) # Sterne's exact method
library(simpleboot) # BS
library(boot) # BS
WATWMdata <- read.csv("../data/WATWMdata.csv")
BALdata <- read.csv("../data/BALdata.csv")
# add 1 for worms/oocysts count!!
WATWMdata$`Aspiculuris.Syphacia+1` <- WATWMdata$Aspiculuris.Syphacia + 1
BALdata$`Aspiculuris.Syphacia+1` <- BALdata$Aspiculuris_Syphacia + 1
BALdata$`OPG+1` <- BALdata$OPG + 1
# and select variables for each analysis
pinworms_data <- BALdata[!is.na(BALdata$`Aspiculuris.Syphacia+1`) &
!is.na(BALdata$HI) &
!is.na(BALdata$Sex),]
WATWMdata <- WATWMdata[!is.na(WATWMdata$`Aspiculuris.Syphacia+1`) &
!is.na(WATWMdata$HI) &
!is.na(WATWMdata$Sex), ]
# all worms together for comparison
d1 <- WATWMdata[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d2 <- pinworms_data[c("Sex", "Aspiculuris.Syphacia+1", "HI")]
d1$batch <- "WATWM"
d2$batch <- "JENNY"
allWorms <- rbind(d1,d2)
allWorms$batch <- as.factor(allWorms$batch)
# BALdata <-
BALdata[BALdata$Year %in% c(2014:2017),]
# BALdata <-
BALdata[BALdata$Year %in% c(2014:2017),]
# BALdata <-
sub <-BALdata[BALdata$Year %in% c(2014:2017),]
# BALdata <-
sub <-BALdata[BALdata$Year %in% c(2015:2017),]
range(BALdata$Latitude)
range(BALdata$Longitude)
View(BALdata)
# Plot my samples
getarea <- function(df, margin = 1, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
area <- getarea(pinworms_data)
library(ggmap)
area <- getarea(pinworms_data)
library(legendMap)
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
# Plot my samples
getarea <- function(df, margin = .5, zoom = 8,
source = "stamen", maptype = "toner-lite"){
# get a map
area <- get_map(location =
c(min(df$Longitude - margin),
min(df$Latitude - margin),
max(df$Longitude + margin),
max(df$Latitude +  margin)),
source = source, maptype= maptype,
zoom = zoom)
}
library(ggmap)
area <- getarea(pinworms_data)
library(legendMap)
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = BALdata, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = pinworms_data, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
# pdf(file = "../Articles_HMHZ/Article1_wild/figures/fig1.pdf", width = 7, height = 6)
ggmap(area) +
geom_point(data = pinworms_data, shape = 21, size = 2,
aes(Longitude, Latitude, fill = HI), alpha = .4) + # set up the points
scale_fill_gradient("Hybrid\nindex", high="red",low="blue") +
geom_rect(xmin = 11, xmax = 12.7, ymin = 50, ymax = 51.3, fill = "white") +
scale_bar(lon = 11.8, lat = 50.9, arrow_length = 10, arrow_distance = 20,
distance_lon = 20, distance_lat = 5, distance_legend = 10,
dist_unit = "km", orientation = TRUE, legend_size = 2, arrow_north_size = 3)
